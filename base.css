/* Global
======================================== */

/**
1. Use the more intuitive alternative box model, globally (default is content-box).
2. Don't repeat background images by default.
3. Don't repeat mask images by default.
*/

*,
*::before,
*::after {
	box-sizing: border-box; /* 1 */
	background-repeat: no-repeat; /* 2 */
	mask-repeat: no-repeat; /* 3 */
}

/*
1. Use a sans serif font by default.
2. The default 'normal' line-height is tightly spaced, but takes font-metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages.
3. Break words when there is not enough space to prevent text overflow.
4. Use a shorter, more readable tab size (default is 8).
5. Prevent WebKit-based browsers on iOS from automatically increasing the default font size in landscape orientation (see https://kilianvalkhof.com/2022/css-html/your-css-reset-needs-text-size-adjust-probably/).
6. Prevent unwanted layout shifts caused by scrollbars when text get longer.
*/

html {
	font-family: sans-serif; /* 1 */
	line-height: 1.5; /* 2 */
	overflow-wrap: break-word; /* 3 */
	tab-size: 4; /* 4 */
	-webkit-text-size-adjust: none; /* 5 */
	scrollbar-gutter: stable; /* 6 */
}

/*
Smooth scrolling, but only when focused in the page to prevent unnaturally scrolling when tabbing though the results of a search.
*/

html:focus-within {
	scroll-behavior: smooth;
}

/*
When users prefer reduced motion:
1. Remove fixed background attachment.
2. Remove transitions.
3. Remove animations/immediately jump any animation to the end point.
4. Remove timed scrolling behaviors.
*/

@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		background-attachment: initial !important; /* 1 */
		transition-delay: 0s !important; /* 2 */
		transition-duration: 0s !important; /* 2 */
		animation-duration: 1ms !important; /* 3 */
		animation-delay: -1ms !important; /* 3 */
		animation-iteration-count: 1 !important; /* 3 */
		scroll-behavior: auto !important; /* 4 */
	}

	html:focus-within {
		scroll-behavior: auto; /* 4 */
	}
}

/*
Anything that has been anchored to should have extra scroll margin.
Reference: https://piccalil.li/blog/a-more-modern-css-reset/
*/

:target {
	scroll-margin-block: 5ex;
}

/* Sections
======================================== */

/*
Remove the usually unwanted default 8px margin in favor of better control in authored CSS.
*/

body {
	margin: 0;
}

/*
Make easier to make 'main' element fill the entire viewport height in case using 100vh is not wanted.
*/

html {
	block-size: 100%;
}

body {
	min-block-size: 100%;
}

/*
Prevent the font size and margin of 'h1' element from decreasing when nested inside sectioning elements (article, aside, nav, section).
Reference: https://github.com/whatwg/html/issues/7867
*/

:where(h1) {
	margin-block: 0.67em;
	font-size: 2em;
}

/*
The default 'normal' line-height is tightly spaced, but takes font-metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages.
*/

h1,
h2,
h3,
h4,
h5,
h6 {
	line-height: 1.25;
}

/*
Switch to rem units for headings.
*/

h1 {
	font-size: 2rem;
}

h2 {
	font-size: 1.5rem;
}

h3 {
	font-size: 1.17rem;
}

h4 {
	font-size: 1rem;
}

h5 {
	font-size: 0.83rem;
}

h6 {
	font-size: 0.67rem;
}

/* Grouping content
======================================== */

/*
1. Correct the inheritance and scaling of font size in all browsers.
2. Correct the odd 'em' font sizing in all browsers.
3. Prevent overflow of the container.
*/

pre {
	font-family: monospace, monospace; /* 1 */
	font-size: 1em; /* 2 */
	white-space: pre-wrap; /* 3 */
}

/*
Give 'hr' element a more modern default look, and make it easier to customize:
- Color: use 'color' or 'border-color'
- Style: use 'border-style'
- Width: use 'border-block-start-width'
1. Needed to override the default 'gray' color set by Firefox and Safari (which correctly follow the HTML spec: https://html.spec.whatwg.org/multipage/rendering.html#the-hr-element-2).
2. Default is 'inset'.
3. Default is 1px (= 2px height).
*/

hr {
	color: inherit; /* 1 */
	border-style: solid; /* 2 */
	border-width: 0; /* 3 */
	border-block-start-width: 2px;
}

/*
The default 'normal' line-height is tightly spaced, but takes font-metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages.
*/

figcaption {
	line-height: 1.375;
}

/*
Remove the default 40px indentation from 'figure' and 'menu' elements, which is usually not wanted, in favor of better control in authored CSS.
*/

figure {
	margin-inline: 0;
}

menu {
	padding-inline-start: 0;
}

/*
Replace the default 40px indentation of 'blockquote', 'dd', 'ol' and 'ul' elements with a value relative to the font.
Loosely based on https://github.com/jensimmons/cssremedy/issues/17
*/

:where(blockquote) {
	margin-inline: 3ch;
}

:where(dd) {
	margin-inline-start: 3ch;
}

:where(ol, ul) {
	padding-inline-start: 3ch;
}

/*
Increase the gap after the list marker for 'ol' and 'ul' elements.
*/

:where(:is(ol, ul) > li) {
	padding-inline-start: 0.5ch;
}

/* Text-level semantics
======================================== */

/*
Keep the default font weight of 'b' and 'strong' elements consistent across browsers.
Reference: https://css-tricks.com/firefoxs-bolder-default-is-a-problem-for-variable-fonts/
*/

b,
strong {
	font-weight: bold;
}

/*
1. Correct the inheritance and scaling of font size in all browsers.
2. Correct the odd 'em' font sizing in all browsers.
*/

code,
kbd,
samp {
	font-family: monospace, monospace; /* 1 */
	font-size: 1em; /* 2 */
}

/* Embedded content
======================================== */

/*
Block by default is usually what we want/the most common use case (default is 'inline').
*/

audio,
canvas,
embed,
iframe,
img,
object,
video {
	display: block;
}

/*
Responsive by default to prevent them from growing beyond the container.
*/

audio,
canvas,
embed,
iframe,
img,
object,
svg,
video {
	max-inline-size: 100%;
}

/*
Maintain intrinsic aspect ratios when 'max-inline-size' is applied.
Note: 'embed', 'iframe' and 'object' elements have no intrinsic ratio, so their 'block-size' needs to be set explicitly.
*/

canvas,
img,
svg,
video {
	block-size: auto;
}

/*
TODO: REMOVE THIS?
The display is inline by default, but that's not the expected behavior. This can interfere with proper layout and aspect-ratio handling.
1. Remove the unnecessary wrapping 'picture', while maintaining contents.
2. Source elements have nothing to display, so we hide them entirely.
*/

picture {
	display: contents; /* 1 */
}

source {
	display: none; /* 2 */
}

/*
There is no good reason 'audio' element default to 300px, and audio files are unlikely to come with a 'width' attribute.
*/

audio {
	inline-size: 100%;
}

/*
TODO: Too opinionated? Remove it?
Use a more useful 'vertical-align' default value for SVGs (default is 'baseline'), in case authors want to use them as inline icons.
*/

svg {
	vertical-align: middle;
}

/*
TODO: Too opinionated? Remove it?
Make SVGs inherit color if neither they nor their 'path' elements have a 'fill' attribute.
*/

svg:where(:not([fill]):has(> path:not([fill]))) {
	fill: currentcolor;
}

/*
Change the border appearance.
*/

iframe {
	border-color: currentcolor;
	border-style: solid;
}

/* Tabular data
======================================== */

/*
1. Collapse border spacing.
2. Correct table border color inheritance in Chrome and Safari.
*/

table {
	border-collapse: collapse; /* 1 */
	border-color: currentcolor; /* 2 */
}

/*
The default 'normal' line-height is tightly spaced, but takes font-metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages.
*/

caption {
	line-height: 1.375;
}

/*
Make 'th' alignment consistent with 'td' alignment.
*/

th {
	text-align: start;
}

/*
TODO: Very opinionated? Remove it?
Add paddings and borders to table cells.
*/

th,
td {
	padding-block: 0.25em;
	padding-inline: 0.5em;
	border: 1px solid;
}

/* Forms
======================================== */

/*
1. Responsive by default by restricting sizing to the page width.
2. Remove the margin on controls in all browsers.
3. Add typography inheritance.
4. TODO: Include this? See UA styles. Better default look and easier to customize.
*/

button,
input,
select,
textarea {
	max-inline-size: 100%; /* 1 */
	margin: 0; /* 2 */
	font: inherit; /* 3 */
	letter-spacing: inherit; /* 3 */
	word-spacing: inherit; /* 3 */
	color: inherit; /* 4 */
	background-color: inherit; /* 4 */
	border: 0.125em solid; /* 4 */
}

/*
TODO: Review this.
Under-Engineered Text Boxen
https://adrianroselli.com/2019/09/under-engineered-text-boxen.html
*/

textarea,
input:not([type="checkbox"]):not([type="file"]):not([type="image"]):not([type="radio"]):not([type="range"]) {
	border: 0.0625em solid;
	padding: 0.5em;
}

textarea:focus,
input:not([type="checkbox"]):not([type="file"]):not([type="image"]):not([type="radio"]):not([type="range"]):focus {
	outline: 0.125em solid #00f;
	box-shadow: 0 0 0.5em #0bf;
}

textarea[readonly],
input:not([type="checkbox"]):not([type="file"]):not([type="image"]):not([type="radio"]):not([type="range"])[readonly] {
	border-color: rgba(0, 0, 0, 0.42);
	border-block-start: none;
	border-inline-start: none;
	border-inline-end: none;
}

textarea[required],
input:not([type="checkbox"]):not([type="file"]):not([type="image"]):not([type="radio"]):not([type="range"])[required] {
	border-inline-start-width: 0.3em;
}

textarea[aria-invalid="true"],
textarea[aria-invalid="spelling"],
textarea[aria-invalid="grammar"],
input:not([type="checkbox"]):not([type="file"]):not([type="image"]):not([type="radio"]):not([type="range"])[aria-invalid] {
	background: linear-gradient(135deg, rgba(255, 0, 0, 1) 0, rgba(255, 0, 0, 1) 0.4em, rgba(255, 255, 255, 1) 0.4em);
}

*[dir="rtl"] textarea[aria-invalid="true"],
*[dir="rtl"] textarea[aria-invalid="spelling"],
*[dir="rtl"] textarea[aria-invalid="grammar"],
*[dir="rtl"] input:not([type="checkbox"]):not([type="file"]):not([type="image"]):not([type="radio"]):not([type="range"])[aria-invalid] {
	background: linear-gradient(225deg, rgba(255, 0, 0, 1) 0, rgba(255, 0, 0, 1) 0.4em, rgba(255, 255, 255, 1) 0.4em);
}

/*
TODO: Make ::placeholder easier to customize?
Correct the text style of placeholders in Chrome and Safari.
*/

::placeholder {
	color: inherit;
	opacity: 1;
}

/*
1. Change font properties to 'inherit' in Safari.
2. Correct the inability to style upload buttons in iOS and Safari.
*/

::-webkit-file-upload-button {
	font: inherit; /* 1 */
	-webkit-appearance: button; /* 2 */
}

/*
1. Remove the default margin.
2. Change the border appearance.
*/

fieldset {
	margin-inline: 0; /* 1 */
	border-color: currentcolor; /* 2 */
	border-style: solid; /* 2 */
}

/*
The default 'normal' line-height is tightly spaced, but takes font-metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages.
*/

label,
legend {
	line-height: 1.375;
}

/*
Set 'vertical-align' to middle.
*/

[type="color" i],
[type="range" i] {
	vertical-align: middle;
}

/* Accessibility
======================================== */

/*
Make elements with a 'hidden' attribute stay hidden even if a different display value is set.
References:
- https://github.com/jensimmons/cssremedy/commit/64106f4
- https://github.com/tailwindlabs/tailwindcss/commit/b570e2b
*/

[hidden]:where(:not([hidden="until-found"])) {
	display: none !important;
}

/*
Change the cursor on busy elements.
*/

[aria-busy="true" i] {
	cursor: progress;
}

/*
Change the cursor on disabled, not-editable, or otherwise inoperable elements.
*/

[disabled],
[aria-disabled="true" i] {
	cursor: not-allowed;
}

/*
Change the display on visually hidden accessible elements.
*/

[aria-hidden="false" i][hidden] {
	display: initial;
}

[aria-hidden="false" i][hidden]:not(:focus) {
	/* Visually hidden styles */
	position: absolute !important;
	inline-size: 1px !important;
	block-size: 1px !important;
	overflow: hidden !important;
	clip-path: inset(50%) !important;
	white-space: nowrap !important;
}

/* Interactive elements
======================================== */

/*
Set the cursor for 'summary' element to be the same as buttons by default, so they feel more interactive.
Use the same default cursor used for buttons to make it feel interactive (default is 'text').
*/

:where(details > summary:first-of-type) {
	cursor: default;
}
