/* ==================================================
Legend:
TODO: Improve
ðŸ”§ = Normalizing styles that fix cross-browser bugs and inconsistencies.
âœ… = Sensible, better and commonly used defaults that address unexpected behaviors. These are safe to apply.
ðŸ†— = Useful defaults nice to have.
âœ¨ = More opinionated defaults.
================================================== */

/* Global
================================================== */

/*
1. Use the more intuitive and predictable border box sizing by default. (refs. https://github.com/jensimmons/cssremedy/issues/4 and https://wiki.csswg.org/ideas/mistakes). âœ…
2. Don't repeat background images by default (ref. https://github.com/w3c/csswg-drafts/issues/4526). âœ…
3. Don't repeat mask images by default. ðŸ†—
*/

*,
::before,
::after {
	box-sizing: border-box; /* 1 */
	background-repeat: no-repeat; /* 2 */
	mask-repeat: no-repeat; /* 3 */
}

/*
Revert adding 'background-repeat: no-repeat' to some form elements because it disables their native appearance in WebKit (bug: https://bugs.webkit.org/show_bug.cgi?id=117128#c2). âœ…
*/

:where(button, input, meter, progress, select),
:where(button, input, meter, progress, select)::before,
:where(button, input, meter, progress, select)::after {
	background-repeat: revert;
}

/*
1. A prerequisite for the 'body' to be able to fill the viewport height (requires 'body { min-block-size: 100%; }', see 'body' rule below). Ref. https://codepen.io/germanfrelo/pen/jOGNpbj ðŸ†—
2. Use a sans serif font by default. ðŸ†—
3. The default 'normal' line-height is tightly spaced, but takes font metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages. ðŸ†—
4. Break words when there is not enough space to prevent text overflow. ðŸ†—
5. Use a shorter, more readable tab size (default is 8). ðŸ†—
6. Prevent WebKit-based browsers on iOS from automatically increasing the default font size in landscape orientation (demo: https://codepen.io/germanfrelo/pen/JoPJVxd). ðŸ”§
7. Prevent unwanted layout shifts caused by scrollbars when text gets longer. ðŸ†—
*/

html {
	block-size: 100%; /* 1 */
	font-family: sans-serif; /* 2 */
	line-height: 1.5; /* 3 */
	overflow-wrap: break-word; /* 4 */
	tab-size: 4; /* 5 */
	-webkit-text-size-adjust: none; /* 6 */ /* stylelint-disable-line property-no-vendor-prefix -- Intended. */
	scrollbar-gutter: stable; /* 7 */
}

/*
Smooth scrolling, but only when focused in the page to prevent unnaturally scrolling when tabbing though the results of a search. ðŸ†—
*/

html:focus-within {
	scroll-behavior: smooth;
}

/*
When users prefer reduced motion: ðŸ†—
1. Remove fixed background attachment.
2. Remove transitions.
3. Remove animations/immediately jump any animation to the end point.
4. Remove timed scrolling behaviors.
*/

@media (prefers-reduced-motion: reduce) {
	*,
	*::before,
	*::after {
		background-attachment: initial !important; /* 1 */
		transition-delay: 0s !important; /* 2 */
		transition-duration: 0s !important; /* 2 */
		animation-duration: 1ms !important; /* 3 */
		animation-delay: -1ms !important; /* 3 */
		animation-iteration-count: 1 !important; /* 3 */
		scroll-behavior: auto !important; /* 4 */
	}

	html:focus-within {
		scroll-behavior: auto; /* 4 */
	}
}

/*
When scrolling to target elements, a reasonable spacing is added above them to ensure they remain visible, especially with sticky headers or similar. Adjust as needed.
Reference: https://piccalil.li/blog/a-more-modern-css-reset/
ðŸ†—
*/

:target {
	scroll-margin-block-start: 5em;
}

/* Page
================================================== */

/*
1. Makes 'body' at least as tall as the viewport height (requires 'html { block-size: 100%; }', see 'html' rule above). Reference: https://codepen.io/germanfrelo/pen/jOGNpbj ðŸ†—
2. Remove the default 8px margin from 'body', which is usually not wanted, in favor of better control in authored CSS. ðŸ†—
*/

body {
	min-block-size: 100%; /* 1 */
	margin: 0; /* 2 */
}

/* Headings
================================================== */

/*
Prevent the 'font-size' and 'margin' of 'h1' from decreasing when nested inside sectioning elements ('article', 'aside', 'nav', 'section'). âœ…
Refs.:
- https://github.com/jensimmons/cssremedy/issues/2
- https://developer.mozilla.org/en-US/docs/Web/HTML/Element/Heading_Elements#avoid_using_multiple_h1_elements_on_one_page
- https://github.com/whatwg/html/issues/7867
*/

:where(h1) {
	margin-block: 0.67em;
	font-size: 2em;
}

/*
The default 'normal' line-height is tightly spaced, but takes font metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages. âœ¨
*/

h1,
h2,
h3,
h4,
h5,
h6 {
	line-height: 1.25;
}

/*
Switch to rem units for headings. âœ…
*/

h1 {
	font-size: 2rem;
}

h2 {
	font-size: 1.5rem;
}

h3 {
	font-size: 1.17rem;
}

h4 {
	font-size: 1rem;
}

h5 {
	font-size: 0.83rem;
}

h6 {
	font-size: 0.67rem;
}

/* Grouping content
================================================== */

/*
1. Fix the inheritance and scaling of the font size in all browsers. ðŸ”§ Refs.:
https://www.brunildo.org/test/monospace_fsize.html
https://bugzilla.mozilla.org/show_bug.cgi?id=175415
https://www.456bereastreet.com/archive/200408/sizing_monospaced_fonts/
https://webkit.org/blog/67/strange-medium/
https://www.456bereastreet.com/archive/200609/font_size_inconsistencies_with_fontfamily_monospace/
https://neugierig.org/software/chromium/notes/2009/04/monospace-fonts.html
https://neugierig.org/software/chromium/notes/2009/09/monospace-fonts-workaround.html
https://meyerweb.com/eric/thoughts/2010/02/12/fixed-monospace-sizing/
https://github.com/necolas/normalize.css/commit/5daad010a2f19c12b89f317ba9d2c8e4573210d7
https://github.com/necolas/normalize.css/issues/519#issuecomment-197131966
2. Fix the odd 'em' font sizing in all browsers. ðŸ”§
3. Prevent content from overflowing while preserving formatting. ðŸ†—
*/

pre {
	font-family: monospace, monospace; /* 1 */
	font-size: 1em; /* 2 */
	overflow-x: auto; /* 3 */
}

/*
ðŸ†— Sets a consistent and modern default look for 'hr':
1. Reverts the default 'gray' color in Firefox and WebKit to allow the text foreground color to be used as the border color.
2. Removes all default '1px inset' borders to instead use a single border with a 'solid' style and a border width of '2px' to have the same height as before.
*/

hr {
	color: inherit; /* 1 */
	border: none; /* 2 */
	border-block-start: 2px solid; /* 2 */
}

/*
The default 'normal' line-height is tightly spaced, but takes font metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages. âœ¨
*/

figcaption {
	line-height: 1.375;
}

/*
Remove the default 40px indentation from 'figure' and 'menu', which is usually not wanted, in favor of better control in authored CSS. ðŸ†—
*/

figure {
	margin-inline: 0;
}

menu {
	padding-inline-start: 0;
}

/*
Replace the default 40px indentation of 'blockquote', 'dd', 'ol' and 'ul' with a value relative to the font. âœ¨
*/

:where(blockquote) {
	margin-inline: 3ch;
}

:where(dd) {
	margin-inline-start: 3ch;
}

:where(ol, ul) {
	padding-inline-start: 3ch;
}

/*
Increase the gap after the list marker for 'ol' and 'ul'. âœ¨
*/

:where(:is(ol, ul) > li) {
	padding-inline-start: 0.5ch;
}

/* Text-level semantics
================================================== */

/*
Keep the default 'font-weight' of 'b' and 'strong' consistent across browsers (ref. https://css-tricks.com/firefoxs-bolder-default-is-a-problem-for-variable-fonts/). ðŸ”§
*/

b,
strong {
	font-weight: bold;
}

/*
1. Fix the inheritance and scaling of the font size in all browsers. ðŸ”§
2. Fix the odd 'em' font sizing in all browsers. ðŸ”§
*/

code,
kbd,
samp {
	font-family: monospace, monospace; /* 1 */
	font-size: 1em; /* 2 */
}

/* Embedded content
================================================== */

/*
Block by default is usually what we want/the most common use case (default is 'inline'). âœ…
*/

audio,
canvas,
embed,
iframe,
img,
object,
video {
	display: block;
}

/*
Responsive by default to prevent them from growing beyond the container. âœ…
*/

audio,
canvas,
embed,
iframe,
img,
object,
svg,
video {
	max-inline-size: 100%;
}

/*
Maintain intrinsic aspect ratios when 'max-inline-size' is applied ('embed', 'iframe' and 'object' have no intrinsic ratio, so their 'block-size' needs to be set explicitly). âœ…
*/

canvas,
img,
svg,
video {
	block-size: auto;
}

/*
'picture' and 'source' display inline by default, but that's not the expected behavior for either one. This can interfere with proper layout and aspect-ratio handling. ðŸ†—
1. Remove the unnecessary wrapping 'picture', while maintaining contents.
2. Source elements have nothing to display, so we hide them entirely.
References:
- https://github.com/jensimmons/cssremedy/commit/59aee673c02e2412140d375c1d45019f78ae40c9
- https://github.com/whatwg/html/issues/4995
*/

picture {
	display: contents; /* 1 */
}

source {
	display: none; /* 2 */
}

/*
There is no good reason 'audio' defaults to 300px, and audio files are unlikely to come with a 'width' attribute. âœ¨
*/

audio {
	inline-size: 100%;
}

/*
TODO: Too opinionated? Remove it?
Use a more useful 'vertical-align' default value for SVGs (default is 'baseline'), in case authors want to use them as inline icons. âœ¨
*/

svg {
	vertical-align: middle;
}

/*
TODO: Too opinionated? Remove it?
Make SVGs inherit color if neither they nor their 'path' have a 'fill' attribute. âœ¨
*/

svg:where(:not([fill]):has(> path:not([fill]))) {
	fill: currentcolor;
}

/*
Change the border appearance. âœ¨
*/

iframe {
	border-color: currentcolor;
	border-style: solid;
}

/* Tabular data
================================================== */

/*
TODO: Too opinionated? 1. Ensure numbers line up (ref: https://github.com/jensimmons/cssremedy/issues/39#issuecomment-473012250) âœ¨
2. Prevent double borders. âœ…
3. Fix the default table 'border-color: gray' on Chrome (bug: https://issues.chromium.org/issues/40615503). ðŸ”§
*/

table {
	font-variant-numeric: tabular-nums; /* 1 */
	border-collapse: collapse; /* 2 */
	border-color: currentcolor; /* 3 */
}

/*
Make 'th' alignment consistent with 'td' alignment. âœ¨
*/

th {
	text-align: inherit;
}

/*
Add paddings and borders to table cells. âœ¨
*/

:where(th, td) {
	padding-block: 0.25em;
	padding-inline: 0.5rem;
	border: 1px solid;
}

/*
The default 'normal' line-height is tightly spaced, but takes font metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages. âœ¨
*/

caption {
	line-height: 1.375;
}

/* Forms
================================================== */

/*
1. Remove the default 2px 'margin-inline' from 'fieldset', which is usually not wanted, in favor of better control in authored CSS. ðŸ†—
2. Change the default 'fieldset' border appearance. âœ¨
*/

fieldset {
	margin-inline: 0; /* 1 */
	border: 1px solid; /* 2 */
}

/*
The default 'normal' line-height is tightly spaced, but takes font metrics into account, which is important for many fonts. Looser spacing may improve readability in latin type, but may cause problems in some scripts -- from cursive/fantasy fonts to Javanese, Persian, and CJK languages. âœ¨
*/

label,
legend {
	line-height: 1.375;
}

/*
Replace the default 2px inline padding of 'legend' with a value relative to the font. âœ¨
*/

legend {
	padding-inline: 0.125em;
}

/*
1. Responsive by default by restricting sizing to the page width. âœ…
2. Add typography inheritance ('line-height' is reverted to avoid removing their native appearance in WebKit). âœ…
3. Add color inheritance. ðŸ†—
*/

button,
input,
select,
textarea {
	max-inline-size: 100%; /* 1 */
	font: inherit; /* 2 */
	line-height: revert; /* 2 */
	letter-spacing: inherit; /* 2 */
	word-spacing: inherit; /* 2 */
	color: inherit; /* 3 */
}

/*
Remove Firefox's default 1px 'margin-block' from 'textarea' for consistency across browsers (bug: https://bugzilla.mozilla.org/show_bug.cgi?id=73817). ðŸ”§
*/

textarea {
	margin-block: 0;
}

/*
Remove the default margin from some form elements, which is usually not wanted, in favor of better control in authored CSS. ðŸ†—
*/

input[type="checkbox" i],
input[type="radio" i],
input[type="range" i] {
	margin: 0;
}

/*
1. Normalizes the placeholder color with a new default value that is consistent and accessible across browsers (reference: https://codepen.io/germanfrelo/pen/EaYwZdb) ðŸ”§
2. TODO: Improve comment. Sets a more modern alternative that provides a value for dark color schemes of browsers that is also accesible across the different background colors for dark themes of browsers. âœ¨
*/

::placeholder {
	color: #757575;
}

@supports (color: light-dark(black, white)) {
	::placeholder {
		color: light-dark(hsl(0deg 0% 46%), hsl(0deg 0% 65%));
	}
}

/*
1. Set a consistent margin across browsers. ðŸ”§âœ¨
2. Change font properties to 'inherit' in WebKit. âœ…
*/

::file-selector-button {
	margin-inline-end: 1ch; /* 1 */
	font: inherit; /* 2 */
}

/*
Set 'vertical-align' to middle. âœ¨
*/

[type="color" i],
[type="range" i] {
	vertical-align: middle;
}

/* âœ¨ */

input,
select,
textarea {
	padding: 0.125em 0.25em;
}

button,
[type="button"],
[type="reset"],
[type="submit"] {
	padding: 0.125em 0.5em;
}

[type="checkbox"],
[type="file"],
[type="image"],
[type="radio"],
[type="range"] {
	padding: revert;
}

input,
select,
textarea {
	padding: 0.125em 0.25em;
}

button,
[type="button"],
[type="reset"],
[type="submit"] {
	padding: 0.125em 0.5em;
}

[type="checkbox"],
[type="file"],
[type="image"],
[type="radio"],
[type="range"] {
	padding: revert;
}

/*
TODO: Review this.
Under-Engineered Text Boxen
https://adrianroselli.com/2019/09/under-engineered-text-boxen.html
âœ¨
*/

button,
input:not([type="checkbox"], [type="color"], [type="file"], [type="image"], [type="radio"], [type="range"]),
select,
textarea {
	padding: 0.5em;
	border: 0.0625em solid;
}

input:not([type="checkbox"], [type="color"], [type="file"], [type="image"], [type="radio"], [type="range"]):focus,
textarea:focus {
	outline: 0.0625em solid #00f;
	box-shadow: 0 0 0.5em #0bf;
}

input:not([type="checkbox"], [type="color"], [type="file"], [type="image"], [type="radio"], [type="range"])[readonly],
textarea[readonly] {
	border-color: rgb(0 0 0 / 42%);
	border-block-start: none;
	border-inline-start: none;
	border-inline-end: none;
}

input:not([type="checkbox"], [type="color"], [type="file"], [type="image"], [type="radio"], [type="range"])[required],
textarea[required] {
	border-inline-start-width: 0.25em;
}

input:not([type="checkbox"], [type="color"], [type="file"], [type="image"], [type="radio"], [type="range"])[aria-invalid],
textarea[aria-invalid="true"],
textarea[aria-invalid="spelling"],
textarea[aria-invalid="grammar"] {
	background: linear-gradient(135deg, rgb(255 0 0 / 100%) 0, rgb(255 0 0 / 100%) 0.4em, rgb(255 255 255 / 100%) 0.4em);
}

*[dir="rtl"] input:not([type="checkbox"], [type="color"], [type="file"], [type="image"], [type="radio"], [type="range"])[aria-invalid],
*[dir="rtl"] textarea[aria-invalid="true"],
*[dir="rtl"] textarea[aria-invalid="spelling"],
*[dir="rtl"] textarea[aria-invalid="grammar"] {
	background: linear-gradient(225deg, rgb(255 0 0 / 100%) 0, rgb(255 0 0 / 100%) 0.4em, rgb(255 255 255 / 100%) 0.4em);
}

/* Hidden elements
================================================== */

/*
Make elements with a 'hidden' attribute stay hidden even if a different display value is set.
References:
- https://html.spec.whatwg.org/multipage/rendering.html#hidden-elements
- https://github.com/jensimmons/cssremedy/issues/71#issuecomment-771180150
- https://github.com/tailwindlabs/tailwindcss/commit/b570e2b
âœ¨
*/

[hidden]:not([hidden="until-found" i], embed) {
	display: none !important;
}

/*
Change the display on visually hidden accessible elements. âœ¨
*/

[aria-hidden="false" i][hidden] {
	display: initial;
}

[aria-hidden="false" i][hidden]:not(:focus) {
	position: absolute !important;
	width: 1px !important;
	height: 1px !important;
	padding: 0 !important;
	margin: -1px !important;
	overflow: hidden !important;
	/* For legacy browsers */
	clip: rect(1px, 1px, 1px, 1px);
	/* For modern browsers */
	clip-path: inset(50%);
	/* To prevent words from being squashed together (since they go on separate lines, and some screen readers do not understand line feeds as spaces) */
	white-space: nowrap;
	border: 0 !important;
}

/* Cursor
================================================== */

/*
Set the cursor for 'summary' to be the same as buttons by default, so they feel more interactive.
Use the same default cursor used for buttons to make it feel interactive (default is 'text').
âœ¨
*/

:where(details > summary:first-of-type) {
	cursor: default;
}

/*
Change the cursor on busy elements. âœ¨
*/

[aria-busy="true" i] {
	cursor: progress;
}

/*
Change the cursor on disabled, not-editable, or otherwise inoperable elements. âœ¨
*/

[disabled],
[aria-disabled="true" i] {
	cursor: not-allowed;
}
